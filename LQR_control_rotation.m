function [u] = LQR_control_rotation(s,w,sd,I)
%   LQR控制器

% 输入说明
% s-姿态、w-角速度、sd-姿态指令、I-TM惯量
% 输出说明
% u-力矩指令
% 控制器参数Q1=[100 0 0 0 0 0;
%               0 100 0 0 0 0;
%               0 0 100 0 0 0;
%               0 0 0   1 0 0;
%               0 0 0   0 1 0;
%               0 0 0   0 0 1];
%           R=[1 0 0;
%              0 1 0;
%              0 0 1;];

% 参数设置
h   = 6671000;                %轨道高度
u_  = 398600e9;               %地心引力常数
w0  = (u_/h^3)^0.5;           %轨道角速度
% 转动系数矩阵
Ix  = I(1,1);
Iy  = I(2,2);
Iz  = I(3,3);
A41 = -4*w0^2*Ix^-1*(Iy-Iz);
A52 = -3*w0^2*Iy^-1*(Ix-Iz);
A63 = -w0^2*Iz^-1*(Iy-Ix);
% 控制器增益
K = [-10 , 0 , 1.00031740962556e-06, 1, 0, 0;
      0  ,-10, 0,                    0, 1, 0;
     -1.00031765377332e-06, 0, -10, 0, 0, 1];
% 控制器设计
e = sd-s;
x = [e;
     w];
u = -K*x+[A41*sd(1);
          A52*sd(2);
          A63*sd(3)];
end

